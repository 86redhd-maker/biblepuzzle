<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>말씀 조각 맞추기</title>

  <!-- SUIT 폰트 불러오기 (기존 CSS보다 먼저) -->
  <link href="https://cdn.jsdelivr.net/gh/sunn-us/SUIT/fonts/static/woff2/SUIT.css" rel="stylesheet">

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+KR:wght@300;400;600&display=swap');

    *{margin:0;padding:0;box-sizing:border-box}
    body{
      font-family:'Noto Serif KR',serif;
      background:linear-gradient(135deg,#f5f1e8 0%,#e8dcc0 100%);
      min-height:100vh;padding:20px
    }
    .container{
      max-width:600px;margin:0 auto;background:#fff;border-radius:15px;
      box-shadow:0 10px 30px rgba(139,108,83,.2);overflow:hidden;min-height:80vh
    }

    /* 홈 화면 */
    .home-screen{padding:60px 40px;text-align:center;background:linear-gradient(135deg,#8b6c53 0%,#a67c60 100%);color:#fff;position:relative}
    .admin-link{
      position:absolute;top:20px;right:20px;background:rgba(255,255,255,.2);color:#fff;border:1px solid rgba(255,255,255,.3);
      padding:8px 15px;border-radius:20px;text-decoration:none;font-size:.9em;cursor:pointer;transition:.3s
    }
    .admin-link:hover{background:rgba(255,255,255,.3)}
    .home-screen h1{font-size:2.2em;margin-bottom:20px;font-weight:600}
    .home-screen p{font-size:1.1em;margin-bottom:40px;opacity:.9;line-height:1.6}
    .start-btn{
      background:#fff;color:#8b6c53;border:none;padding:15px 40px;font-size:1.2em;border-radius:50px;cursor:pointer;
      transition:.3s; font-weight:600; box-shadow:0 5px 15px rgba(0,0,0,.2)
    }
    .start-btn:hover{transform:translateY(-3px); box-shadow:0 8px 20px rgba(0,0,0,.3)}

    /* 퍼즐 화면 */
    .puzzle-screen{display:none;padding:30px}
    .puzzle-header{text-align:center;margin-bottom:30px}
    .puzzle-header h2{color:#8b6c53;font-size:1.5em;margin-bottom:10px}
    .verse-info{background:#f8f6f0;padding:10px 20px;border-radius:25px;color:#8b6c53;font-weight:600;display:inline-block}
    .instruction{background:#e3f2fd;border-left:4px solid #2196f3;padding:15px;margin:20px 0;border-radius:0 10px 10px 0;color:#1976d2;font-size:.95em}
    .puzzle-area{background:#f8f6f0;border-radius:15px;padding:25px;margin-bottom:30px;min-height:300px}
    .puzzle-piece{
      background:#fff;border:3px solid #e8dcc0;border-radius:10px;padding:15px 20px;margin:8px 0;cursor:pointer;transition:.3s;
      box-shadow:0 3px 10px rgba(139,108,83,.1);font-size:1.05em;line-height:1.4;user-select:none;-webkit-tap-highlight-color:transparent
    }
    .puzzle-piece:hover{border-color:#8b6c53;transform:translateY(-2px);box-shadow:0 5px 15px rgba(139,108,83,.2)}
    .puzzle-piece:active{transform:scale(.98)}
    .puzzle-piece.selected{border-color:#ffc107!important;background:#fff8dc!important;box-shadow:0 0 20px rgba(255,193,7,.4)!important;transform:translateY(-3px)!important}
    .puzzle-piece.correct{border-color:#28a745;background:#f8fff8}

    .controls{display:flex;gap:15px;justify-content:center;flex-wrap:wrap}
    .btn{
      background:#8b6c53;color:#fff;border:none;padding:12px 25px;border-radius:25px;cursor:pointer;transition:.3s;font-weight:500
    }
    .btn:hover{background:#a67c60;transform:translateY(-2px)}
    .btn:disabled{background:#ccc;cursor:not-allowed;transform:none}
    .hint-btn{background:#17a2b8}
    .hint-btn:hover{background:#138496}

    /* 결과 화면 */
    .result-screen{display:none;padding:30px;text-align:center}
    .result-title{font-size:1.8em;color:#28a745;margin-bottom:20px}
    .correct-verse{background:#f8fff8;border:2px solid #28a745;border-radius:15px;padding:25px;margin:20px 0;font-size:1.15em;line-height:1.6;color:#333}
    .explanation{background:#fff8dc;border-left:4px solid #8b6c53;padding:20px;margin:20px 0;text-align:left;border-radius:0 10px 10px 0}
    .explanation h4{color:#8b6c53;margin-bottom:10px}
    .share-controls{margin-top:30px}
    .new-game-btn{background:#8b6c53;margin-top:15px}

    /* 관리자 화면 */
    .admin-screen{display:none;padding:30px}
    .admin-header{text-align:center;margin-bottom:30px;color:#8b6c53}
    .verse-list{margin-bottom:30px}
    .verse-item{background:#f8f6f0;border-radius:10px;padding:20px;margin-bottom:15px;border-left:4px solid #8b6c53}
    .verse-reference{font-weight:600;color:#8b6c53;margin-bottom:10px}
    .verse-pieces{margin-bottom:10px;line-height:1.5}
    .verse-explanation{font-size:.9em;color:#666;font-style:italic}
    .verse-actions{margin-top:10px}
    .edit-btn{background:#17a2b8;font-size:.9em;padding:8px 15px;margin-right:10px}
    .delete-btn{background:#dc3545;font-size:.9em;padding:8px 15px}
    .admin-form{background:#fff;border-radius:15px;padding:25px;box-shadow:0 5px 15px rgba(139,108,83,.1);margin-bottom:20px}
    .form-group{margin-bottom:20px}
    .form-label{display:block;color:#8b6c53;font-weight:600;margin-bottom:8px}
    .form-input{width:100%;padding:12px 15px;border:2px solid #e8dcc0;border-radius:8px;font-family:inherit;transition:border-color .3s}
    .form-input:focus{outline:none;border-color:#8b6c53}
    .form-textarea{min-height:120px;resize:vertical}
    .pieces-input{margin-bottom:10px}
    .add-piece-btn{background:#28a745;font-size:.9em;padding:8px 15px}
    .piece-item{display:flex;gap:10px;margin-bottom:10px;align-items:center}
    .piece-input{flex:1}
    .remove-piece-btn{background:#dc3545;font-size:.8em;padding:5px 10px}
    .back-btn{background:#6c757d}

    /* 모바일 최적화 */
    @media (max-width:768px){
      .container{margin:10px;border-radius:10px}
      .home-screen{padding:40px 20px}
      .home-screen h1{font-size:1.8em}
      .puzzle-screen,.result-screen,.admin-screen{padding:20px}
      .puzzle-piece{padding:12px 15px;font-size:1em}
      .controls{flex-direction:column;align-items:center}
      .admin-link{position:static;display:inline-block;margin-bottom:20px}
    }

    .hidden{display:none!important}
    .password-modal{
      position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.5);
      display:flex;justify-content:center;align-items:center;z-index:1000
    }
    .password-modal-content{background:#fff;padding:30px;border-radius:15px;text-align:center;max-width:400px;width:90%}
    .password-input{
      width:100%;padding:12px;margin:20px 0;border:2px solid #e8dcc0;border-radius:8px;text-align:center;font-size:1.1em
    }

    /* 추가된 미니 톤업 CSS */
    :root{--bg:#fafbff;--card:#fff;--ink:#1f2937;--sub:#6b7280;--pri:#6ea8fe;--ok:#65c18c;--warn:#fbc02d;--err:#ef5350;--radius:14px;--radius-sm:10px;--shadow:0 10px 30px rgba(17,24,39,.08)}
    html,body{height:100%}
    .card{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);padding:20px;backdrop-filter:saturate(120%) blur(4px)}
    h1,h2,h3{line-height:1.2;margin:.6em 0 .4em}
    h1{font-size:clamp(24px,4.5vw,36px);letter-spacing:.2px}
    h2{font-size:clamp(20px,3.5vw,28px);color:var(--ink)}
    p.lead{color:var(--sub);font-size:1.05rem}
    .btn{display:inline-flex;align-items:center;gap:.5rem;justify-content:center;min-height:44px}
    .toolbar{position:sticky;bottom:12px;display:flex;gap:8px;flex-wrap:wrap;background:rgba(255,255,255,.7);backdrop-filter:blur(10px);padding:10px;border-radius:999px;box-shadow:var(--shadow)}
    .puzzle{display:flex;flex-wrap:wrap;gap:8px;margin:14px 0 18px}
    .piece{padding:10px 14px;background:#fff;border:1px solid rgba(31,41,55,.12);border-radius:var(--radius-sm);box-shadow:0 2px 8px rgba(31,41,55,.06);line-height:1.35;cursor:pointer;transition:.15s}
    .piece:hover{transform:translateY(-1px)}
    .piece.selected{outline:2px solid var(--pri);background:rgba(110,168,254,.08)}
    .piece.correct{background:rgba(101,193,140,.10);border-color:rgba(101,193,140,.40)}
    .helper{color:var(--sub);font-size:.95rem}
    .result-toast{position:fixed;top:14px;left:50%;transform:translateX(-50%);background:#111;color:#fff;padding:10px 14px;border-radius:999px;box-shadow:var(--shadow);opacity:0;pointer-events:none;transition:.25s}
    .result-toast.show{opacity:1;transform:translate(-50%,4px)}
  </style>
  <style>
    body {
      font-family: 'SUIT', -apple-system, 'Apple SD Gothic Neo', system-ui, sans-serif;
    }
    h1, h2, h3 {
      font-weight: 700;
    }
    /* === Pastel Kids Skin — drop-in override (CSS only) === */
/* 폰트는 SUIT 유지. 더 동글하게 하고 싶으면 h1~h3,.btn 에 NanumSquareRound를 나중에 얹어도 OK */

:root{
  --sky1:#cfe8ff; --sky2:#eaf6ff;
  --ink:#22324a; --sub:#5b6b7a; --edge:rgba(34,50,74,.12);
  --chip1:#BFE3FF; /* 하늘 */
  --chip2:#FFD1E5; /* 핑크 */
  --chip3:#FFF0A6; /* 옐로우 */
  --chip4:#CCF3D2; /* 민트 */
  --chip5:#E2D6FF; /* 라벤더 */
}

/* 1) 전체 배경: 하늘 그라데이션 + 구름/별/퍼즐 데코 */
body{
  background: linear-gradient(180deg,var(--sky1),var(--sky2));
  color:var(--ink);
}
body::before{
  content:"";
  position:fixed; inset:0; pointer-events:none; z-index:0;
  /* ▶ 구름/별/퍼즐 SVG를 여러 레이어로 배치 */
  background-image:
    /* 구름 */
    url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='140' height='70' viewBox='0 0 140 70'><path fill='%23ffffff' fill-opacity='.9' d='M30 55h80a22 22 0 0 0 0-44c-7 0-13 3-17 8A30 30 0 0 0 30 33a18 18 0 1 0 0 22z'/></svg>"),
    url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='110' height='55' viewBox='0 0 110 55'><path fill='%23ffffff' fill-opacity='.85' d='M22 45h66a18 18 0 0 0 0-36c-6 0-10 3-13 6A24 24 0 0 0 22 26a15 15 0 1 0 0 19z'/></svg>"),
    /* 별 */
    url(\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='18' height='18' viewBox='0 0 18 18'><path fill='%23ffe37a' d='M9 0l2 5 5 2-5 2-2 5-2-5-5-2 5-2z'/></svg>\"),
    /* 퍼즐 조각(노랑) */
    url(\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='84' height='84' viewBox='0 0 84 84'><path fill='%23ffd96b' d='M30 8a8 8 0 1 0 16 0h10c8 0 14 6 14 14v6a8 8 0 1 0 0 16v8c0 8-6 14-14 14H46a8 8 0 1 0-16 0H20c-8 0-14-6-14-14V44a8 8 0 1 0 0-16v-6C6 14 12 8 20 8h10z'/></svg>\"),
    /* 퍼즐 조각(핑크) */
    url(\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='84' height='84' viewBox='0 0 84 84'><path fill='%23ffb3c7' d='M30 8a8 8 0 1 0 16 0h10c8 0 14 6 14 14v6a8 8 0 1 0 0 16v8c0 8-6 14-14 14H46a8 8 0 1 0-16 0H20c-8 0-14-6-14-14V44a8 8 0 1 0 0-16v-6C6 14 12 8 20 8h10z'/></svg>\");
  background-repeat:no-repeat, no-repeat, repeat, no-repeat, no-repeat;
  background-size: 260px 130px, 200px 100px, 18px 18px, 84px 84px, 84px 84px;
  background-position:
    8% 18%, 78% 8%, center 28%, 90% 78%, 10% 82%;
  opacity:.95;
}
.container{ position:relative; z-index:1; border-radius:26px; box-shadow:0 20px 60px rgba(17,24,39,.16) }

/* 2) 홈(히어로): 투명 카드 + 톡톡 튀는 버튼 */
.home-screen{
  background: rgba(255,255,255,.72);
  backdrop-filter: blur(6px) saturate(115%);
  color:var(--ink);
}
.home-screen h1{ font-weight:900; letter-spacing:.4px }
.home-screen p{ color:var(--sub) }
.start-btn{
  border:1px solid var(--edge);
  background: radial-gradient(120% 100% at 50% -10%, rgba(255,255,255,.7), transparent 40%), linear-gradient(#fff,#f7f7f7);
  color:#0f2a5a; font-weight:900;
  box-shadow:0 10px 24px rgba(34,50,74,.18);
}

/* 3) 안내 박스 */
.instruction{
  background: linear-gradient(180deg,#eef6ff,#eaf2ff);
  border:1px solid rgba(110,168,254,.35);
  color:#0f3a75; border-radius:14px; padding:14px 16px; font-weight:800;
}

/* 4) 퍼즐 영역: 반응형 그리드 + 캔디 칩 */
.puzzle-area{
  display:grid; gap:12px;
  grid-template-columns: repeat(auto-fit, minmax(170px,1fr));
  background: linear-gradient(180deg,#fbfdff,#f5f8fe);
  border:1px solid var(--edge); border-radius:16px; padding:18px;
}
.puzzle-piece{
  border:none; border-radius:14px; padding:14px 16px;
  font-weight:900; line-height:1.4; color:#253551;
  box-shadow:0 10px 22px rgba(34,50,74,.10);
  transition: transform .12s ease, box-shadow .12s ease, filter .12s ease;
}
.puzzle-piece:hover{ transform:translateY(-2px); box-shadow:0 16px 28px rgba(34,50,74,.14) }
.puzzle-piece:active{ transform:scale(.985) }
.puzzle-piece.selected{
  outline:3px solid rgba(110,168,254,.55);
  filter:saturate(110%);
}
/* 색상 순환 */
.puzzle-piece:nth-child(5n+1){ background:var(--chip1) }
.puzzle-piece:nth-child(5n+2){ background:var(--chip2) }
.puzzle-piece:nth-child(5n+3){ background:var(--chip3) }
.puzzle-piece:nth-child(5n+4){ background:var(--chip4) }
.puzzle-piece:nth-child(5n){   background:var(--chip5) }

/* 5) 버튼(공통) */
.btn{
  border:1px solid var(--edge);
  background: radial-gradient(120% 100% at 50% -10%, rgba(255,255,255,.65), transparent 40%), linear-gradient(#fff,#f7f7f7);
  color:#1f2d40; font-weight:800; min-height:44px;
  box-shadow:0 6px 18px rgba(31,41,55,.12);
  transition: transform .15s ease, box-shadow .15s ease;
}
.btn:hover{ transform: translateY(-1px) scale(1.01) }
.btn:active{ transform: translateY(0) scale(.99) }
.hint-btn{
  background: linear-gradient(#eaf4ff,#e2f0ff);
  border-color: rgba(110,168,254,.45);
  color:#0f3a75;
}
.back-btn{ background:linear-gradient(#f6f6f6,#eeeeee) }

/* 6) 결과/관리자 카드 톤 */
.correct-verse{
  background: linear-gradient(180deg,#fcfffb,#f7fff7);
  border:1px solid rgba(101,193,140,.45);
  border-radius:18px; box-shadow:0 12px 30px rgba(31,41,55,.10);
  font-weight:800;
}
.explanation{
  background: linear-gradient(180deg,#fff9e6,#fff4d6);
  border-left:4px solid #f0c443; border-radius:10px; font-weight:800;
}
.verse-item{ background:linear-gradient(180deg,#f9fafb,#f7f7f7); border:1px solid var(--edge) }
.verse-reference{ font-weight:900; letter-spacing:.2px; color:#8b6c53 }
.verse-pieces{ font-weight:800; color:var(--ink) }
.verse-explanation{ color:var(--sub) }

/* 7) 접근성 */
:focus-visible{ outline:3px solid rgba(110,168,254,.6); outline-offset:2px; border-radius:10px }

/* 8) 모바일 */
@media (max-width:768px){
  .puzzle-area{ grid-template-columns: repeat(auto-fit, minmax(140px,1fr)) }
}
    /* === Cute Pastel Hero Layout Overhaul (HTML 수정 없이 레이아웃 체감 업) === */

/* 0) 베이스: 컨테이너를 투명화하고 섹션별 카드/히어로는 각자 구성 */
.container{
  background: transparent;
  border: none;
  box-shadow: none;
  max-width: 980px;
}

/* 1) 홈 히어로를 “전체 섹션”로 키우고 중앙 배치 */
.home-screen{
  position: relative;
  min-height: 64vh;            /* 시안처럼 큼직하게 */
  display: grid;
  place-items: center;
  padding: 56px 28px;
  background: none;            /* 기존 그라데이션 제거 */
  color: #22324a;
  z-index: 1;
}
/* 유리 카드(시안의 큰 카드) – pseudo로 생성 */
.home-screen::before{
  content:"";
  position: absolute; inset: 24px;
  border-radius: 28px;
  background: linear-gradient(180deg, rgba(255,255,255,.78), rgba(255,255,255,.92));
  border: 1px solid rgba(255,255,255,.8);
  box-shadow: 0 28px 80px rgba(17,24,39,.18);
  z-index: -1;
  backdrop-filter: blur(6px) saturate(120%);
}
/* 떠다니는 구름/퍼즐/별 데코 (히어로 주변) */
.home-screen::after{
  content:"";
  position: absolute; inset: 0; pointer-events: none; z-index: -2;
  background-image:
    /* 큰 구름 */
    url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='260' height='120' viewBox='0 0 260 120'><path fill='%23ffffff' fill-opacity='.9' d='M50 95h160a44 44 0 1 0-30-76 60 60 0 0 0-98 28 30 30 0 1 0-32 48z'/></svg>"),
    /* 작은 구름 */
    url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='180' height='90' viewBox='0 0 180 90'><path fill='%23ffffff' fill-opacity='.9' d='M36 74h108a28 28 0 1 0-20-48 48 48 0 0 0-66 24 22 22 0 1 0-22 24z'/></svg>"),
    /* 별 */
    url(\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='18' height='18' viewBox='0 0 18 18'><path fill='%23ffe37a' d='M9 0l2 5 5 2-5 2-2 5-2-5-5-2 5-2z'/></svg>\"),
    /* 퍼즐 조각(노랑/핑크) */
    url(\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='84' height='84' viewBox='0 0 84 84'><path fill='%23ffd96b' d='M30 8a8 8 0 1 0 16 0h10c8 0 14 6 14 14v6a8 8 0 1 0 0 16v8c0 8-6 14-14 14H46a8 8 0 1 0-16 0H20c-8 0-14-6-14-14V44a8 8 0 1 0 0-16v-6C6 14 12 8 20 8h10z'/></svg>\"),
    url(\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='84' height='84' viewBox='0 0 84 84'><path fill='%23ffb3c7' d='M30 8a8 8 0 1 0 16 0h10c8 0 14 6 14 14v6a8 8 0 1 0 0 16v8c0 8-6 14-14 14H46a8 8 0 1 0-16 0H20c-8 0-14-6-14-14V44a8 8 0 1 0 0-16v-6C6 14 12 8 20 8h10z'/></svg>\");
  background-repeat: no-repeat, no-repeat, repeat, no-repeat, no-repeat;
  background-size: 260px 120px, 180px 90px, 18px 18px, 84px 84px, 84px 84px;
  background-position: 8% 22%, 82% 8%, center 30%, 88% 82%, 12% 78%;
  opacity: .96;
}
/* 히어로 타이틀/설명을 시안처럼 굵고 큼직하게 */
.home-screen h1{
  font-size: clamp(28px, 5vw, 42px);
  font-weight: 900;
  letter-spacing: .2px;
  margin-bottom: 8px;
  position: relative;
}
/* 이모지 배지(시안 느낌) */
.home-screen h1::before{
  content: "🧩";
  display: inline-block;
  margin-right: .35em;
  filter: drop-shadow(0 3px 6px rgba(0,0,0,.15));
}
.home-screen p{
  font-size: clamp(15px, 2.2vw, 18px);
  color: #5b6b7a;
  margin-bottom: 22px;
}
/* 스타트 버튼을 더 크고 통통하게 */
.start-btn{
  padding: 14px 28px;
  border-radius: 999px;
  font-weight: 900;
  font-size: 1.06rem;
  border: 1px solid rgba(34,50,74,.12);
  background:
    radial-gradient(120% 100% at 50% -10%, rgba(255,255,255,.75), transparent 40%),
    linear-gradient(#fff,#f7f7f7);
  color:#0f2a5a;
  box-shadow: 0 12px 28px rgba(34,50,74,.18);
}

/* 2) 퍼즐 화면도 “카드 섹션”처럼 보이도록 */
.puzzle-screen{
  position: relative;
  display: block;
  padding: 28px 28px 36px;
}
.puzzle-screen::before{
  content:"";
  position:absolute; inset: 10px;
  border-radius: 22px;
  background: linear-gradient(180deg, rgba(255,255,255,.78), rgba(255,255,255,.92));
  border: 1px solid rgba(255,255,255,.8);
  box-shadow: 0 20px 60px rgba(17,24,39,.14);
  z-index: -1;
  backdrop-filter: blur(4px) saturate(115%);
}

/* 3) 칩형 퍼즐 그리드 + 파스텔 조각 */
.puzzle-area{
  display: grid; gap: 12px;
  grid-template-columns: repeat(auto-fit, minmax(170px, 1fr));
  background: linear-gradient(180deg,#fbfdff,#f5f8fe);
  border: 1px solid rgba(34,50,74,.10);
  border-radius: 16px; padding: 18px;
}
.puzzle-piece{
  border: none; border-radius: 14px; padding: 14px 16px;
  font-weight: 900; line-height: 1.4; color:#253551;
  box-shadow: 0 10px 22px rgba(34,50,74,.10);
  transition: transform .12s ease, box-shadow .12s ease, filter .12s ease;
}
.puzzle-piece:hover{ transform: translateY(-2px); box-shadow: 0 16px 28px rgba(34,50,74,.14) }
.puzzle-piece:active{ transform: scale(.985) }
.puzzle-piece.selected{ outline: 3px solid rgba(110,168,254,.55); filter: saturate(110%) }
/* 파스텔 랜덤처럼 보이게 순환 컬러 */
.puzzle-piece:nth-child(5n+1){ background:#BFE3FF }
.puzzle-piece:nth-child(5n+2){ background:#FFD1E5 }
.puzzle-piece:nth-child(5n+3){ background:#FFF0A6 }
.puzzle-piece:nth-child(5n+4){ background:#CCF3D2 }
.puzzle-piece:nth-child(5n){   background:#E2D6FF }

/* 4) 컨트롤 버튼 군집도 시안처럼 통통하게 */
.controls{ gap: 10px; justify-content: center }
.btn{
  border:1px solid rgba(34,50,74,.12);
  background:
    radial-gradient(120% 100% at 50% -10%, rgba(255,255,255,.65), transparent 40%),
    linear-gradient(#fff,#f7f7f7);
  color:#1f2d40; font-weight: 800; min-height: 44px;
  box-shadow: 0 6px 18px rgba(31,41,55,.12);
}
.hint-btn{
  background: linear-gradient(#eaf4ff,#e2f0ff);
  border-color: rgba(110,168,254,.45);
  color:#0f3a75;
}
.back-btn{ background: linear-gradient(#f6f6f6,#eeeeee) }

/* 5) 결과 카드/관리자 카드도 새 톤 */
.result-screen{ position:relative; padding: 28px; text-align:center }
.result-screen::before{
  content:""; position:absolute; inset: 10px; z-index:-1;
  border-radius: 22px; background: linear-gradient(180deg, rgba(255,255,255,.78), rgba(255,255,255,.92));
  border:1px solid rgba(255,255,255,.8); box-shadow: 0 20px 60px rgba(17,24,39,.14);
  backdrop-filter: blur(4px) saturate(115%);
}
.result-title{ font-size: clamp(22px,3.4vw,28px); color:#2a7d52; font-weight: 900 }

.correct-verse{
  background: linear-gradient(180deg,#fcfffb,#f7fff7);
  border:1px solid rgba(101,193,140,.45);
  border-radius:18px; box-shadow:0 12px 30px rgba(31,41,55,.10);
  font-weight:800;
}

.explanation{
  background: linear-gradient(180deg,#fff9e6,#fff4d6);
  border-left:4px solid #f0c443; border-radius:10px; font-weight:800;
}

/* 6) 모바일 보완 */
@media (max-width: 768px){
  .home-screen{ min-height: 58vh; padding: 40px 18px }
  .puzzle-area{ grid-template-columns: repeat(auto-fit, minmax(140px,1fr)) }
}
  </style>
</head>
<body>
  <div class="container">
    <!-- 홈 화면 -->
    <div class="home-screen" id="homeScreen">
      <button class="admin-link" onclick="showPasswordModal()">⚙️ 관리자</button>
      <h1>🧩 말씀 조각 맞추기</h1>
      <p>성경 구절의 순서를 맞춰보세요!<br/>말씀의 흐름을 느끼며 더 깊이 묵상해보아요.</p>
      <button class="start-btn" onclick="startGame()">시작하기</button>
    </div>

    <!-- 퍼즐 화면 -->
    <div class="puzzle-screen" id="puzzleScreen">
      <div class="puzzle-header">
        <h2>말씀 조각을 순서대로 배열해보세요</h2>
        <div class="verse-info" id="verseInfo">마태복음 5:14-16</div>
      </div>

      <div class="instruction">
        📱 <strong>사용법:</strong> 첫 번째 조각을 클릭하고, 바꾸고 싶은 두 번째 조각을 클릭하면 위치가 바뀝니다!
      </div>

      <div class="puzzle-area" id="puzzleArea"></div>

      <div class="controls">
        <button class="btn hint-btn" onclick="showHint()">💡 힌트</button>
        <button class="btn" onclick="checkAnswer()">정답 확인</button>
        <button class="btn" onclick="resetPuzzle()">다시 섞기</button>
        <button class="btn back-btn" onclick="goHome()">🏠 홈</button>
      </div>
    </div>

    <!-- 결과 화면 -->
    <div class="result-screen" id="resultScreen">
      <h2 class="result-title">🎉 정답입니다!</h2>
      <div class="correct-verse" id="correctVerse"></div>

      <div class="explanation">
        <h4>📖 말씀 묵상</h4>
        <p id="explanation"></p>
      </div>

      <div class="share-controls">
        <button class="btn" onclick="saveResult()">📱 결과 저장</button>
        <button class="btn new-game-btn" onclick="newGame()">새로운 퍼즐</button>
        <button class="btn back-btn" onclick="goHome()">🏠 홈</button>
      </div>
    </div>

    <!-- 관리자 화면 -->
    <div class="admin-screen" id="adminScreen">
      <div class="admin-header">
        <h2>⚙️ 구절 관리</h2>
        <p>성경 구절을 추가하거나 수정할 수 있습니다</p>
      </div>

      <!-- JSON Import/Export -->
      <div class="admin-tools" style="display:flex; gap:8px; margin:12px 0;">
        <button class="btn" id="btnExport" type="button">JSON 내보내기</button>
        <button class="btn" id="btnImport" type="button">JSON 가져오기</button>
        <input type="file" id="fileImport" accept="application/json" hidden />
      </div>

      <!-- 새 구절 추가 폼 -->
      <div class="admin-form">
        <h3 style="color:#8b6c53; margin-bottom:20px;">새 구절 추가</h3>

        <div class="form-group">
          <label class="form-label">구절 참조 (예: 마태복음 5:14-16)</label>
          <input type="text" class="form-input" id="newReference" placeholder="성경책 장:절"/>
        </div>

        <div class="form-group">
          <label class="form-label">말씀 조각들</label>
          <div id="piecesContainer">
            <div class="piece-item">
              <input type="text" class="form-input piece-input" placeholder="첫 번째 문장"/>
              <button class="btn remove-piece-btn" onclick="removePiece(this)" type="button">삭제</button>
            </div>
          </div>
          <button class="btn add-piece-btn" onclick="addPiece()" type="button">+ 조각 추가</button>
        </div>

        <div class="form-group">
          <label class="form-label">설교 해설</label>
          <textarea class="form-input form-textarea" id="newExplanation" placeholder="이 말씀의 의미와 교훈을 입력하세요"></textarea>
        </div>

        <div style="text-align:center;">
          <button class="btn" onclick="saveVerse()" type="button">💾 저장하기</button>
          <button class="btn" onclick="clearForm()" type="button">🔄 초기화</button>
        </div>
      </div>

      <!-- 기존 구절 목록 -->
      <div class="verse-list">
        <h3 style="color:#8b6c53; margin-bottom:20px;">등록된 구절들</h3>
        <div id="verseListContainer"></div>
      </div>

      <div style="text-align:center; margin-top:30px;">
        <button class="btn back-btn" onclick="goHome()" type="button">🏠 홈으로 돌아가기</button>
      </div>
    </div>
  </div>

  <!-- 비밀번호 모달 -->
  <div class="password-modal hidden" id="passwordModal">
    <div class="password-modal-content">
      <h3 style="color:#8b6c53; margin-bottom:20px;">관리자 비밀번호</h3>
      <input type="password" class="password-input" id="passwordInput" placeholder="비밀번호를 입력하세요"/>
      <div>
        <button class="btn" onclick="checkPassword()" type="button">확인</button>
        <button class="btn back-btn" onclick="closePasswordModal()" type="button">취소</button>
      </div>
    </div>
  </div>

  <script>
    // 기본 성경 구절 데이터
    const defaultVerses = [
      {
        reference: "마태복음 5:14-16",
        pieces: [
          "너희는 세상의 빛이라",
          "산 위에 있는 동네가 숨겨지지 못할 것이요",
          "사람이 등불을 켜서 말 아래에 두지 아니하고",
          "등경 위에 두나니",
          "이같이 너희 빛이 사람 앞에 비치게 하여",
          "그들로 너희 착한 행실을 보고",
          "하늘에 계신 너희 아버지께 영광을 돌리게 하라"
        ],
        explanation: "이 말씀은 그리스도인들이 세상에서 빛의 역할을 감당해야 함을 교훈합니다. 우리의 착한 행실과 삶을 통해 하나님의 영광을 드러내야 한다는 의미입니다."
      },
      {
        reference: "요한복음 3:16",
        pieces: [
          "하나님이 세상을 이처럼 사랑하사",
          "독생자를 주셨으니",
          "이는 그를 믿는 자마다",
          "멸망하지 않고",
          "영생을 얻게 하려 하심이라"
        ],
        explanation: "성경에서 가장 사랑받는 구절 중 하나로, 하나님의 무조건적인 사랑과 구원의 은혜를 보여주는 말씀입니다."
      }
    ];

    // 상태
    let currentVerse = null;
    let shuffledPieces = [];
    let hintUsed = false;
    let editingIndex = -1;
    let selectedPiece = null;

    // 관리자 비밀번호
    const ADMIN_PASSWORD = "jesus2024";

    // 저장/불러오기
    function loadVerses(){
      const saved = localStorage.getItem('bibleVerses');
      if (saved) return JSON.parse(saved);
      saveVerses(defaultVerses);
      return defaultVerses;
    }
    function saveVerses(verses){
      localStorage.setItem('bibleVerses', JSON.stringify(verses));
    }

    // 게임 플로우
    function startGame(){
      document.getElementById('homeScreen').style.display='none';
      document.getElementById('puzzleScreen').style.display='block';
      loadRandomVerse();
    }
    function goHome(){
      document.getElementById('puzzleScreen').style.display='none';
      document.getElementById('resultScreen').style.display='none';
      document.getElementById('adminScreen').style.display='none';
      document.getElementById('homeScreen').style.display='block';
    }

    function loadRandomVerse(){
      const verses = loadVerses();
      if (verses.length===0){
        alert('등록된 구절이 없습니다. 관리자 화면에서 구절을 추가해주세요.');
        goHome();
        return;
      }
      const randomIndex = Math.floor(Math.random()*verses.length);
      currentVerse = verses[randomIndex];
      document.getElementById('verseInfo').textContent = currentVerse.reference;

      shuffledPieces = [...currentVerse.pieces];
      for (let i=shuffledPieces.length-1;i>0;i--){
        const j = Math.floor(Math.random()*(i+1));
        [shuffledPieces[i],shuffledPieces[j]]=[shuffledPieces[j],shuffledPieces[i]];
      }
      renderPuzzle();
      hintUsed=false; selectedPiece=null;
    }

    function renderPuzzle(){
      const puzzleArea = document.getElementById('puzzleArea');
      puzzleArea.innerHTML='';
      shuffledPieces.forEach((piece,index)=>{
        const el=document.createElement('div');
        el.className='puzzle-piece';
        el.textContent=piece;
        el.dataset.index=index;
        el.addEventListener('click',()=>handlePieceClick(el));
        puzzleArea.appendChild(el);
      });
    }

    function handlePieceClick(clicked){
      if (!selectedPiece){
        selectedPiece=clicked; clicked.classList.add('selected'); return;
      }
      if (selectedPiece===clicked){
        clicked.classList.remove('selected'); selectedPiece=null; return;
      }
      const a = parseInt(selectedPiece.dataset.index,10);
      const b = parseInt(clicked.dataset.index,10);
      [shuffledPieces[a],shuffledPieces[b]]=[shuffledPieces[b],shuffledPieces[a]];
      selectedPiece.classList.remove('selected'); selectedPiece=null;
      renderPuzzle();
    }

    function showHint(){
      if (hintUsed) return;
      const firstPiece = currentVerse.pieces[0];
      document.querySelectorAll('.puzzle-piece').forEach(p=>{
        if (p.textContent===firstPiece){
          p.style.border='3px solid #ffc107';
          p.style.background='#fff8dc';
        }
      });
      alert(`💡 힌트: 첫 번째 문장은 "${firstPiece}"입니다.`);
      hintUsed=true;
    }

    function checkAnswer(){
      const ok = shuffledPieces.every((p,i)=>p===currentVerse.pieces[i]);
      if (ok) showResult(); else alert('아직 순서가 맞지 않아요! 다시 시도해보세요. 😊');
    }

    function showResult(){
      document.getElementById('puzzleScreen').style.display='none';
      document.getElementById('resultScreen').style.display='block';
      document.getElementById('correctVerse').innerHTML =
        `<strong>${currentVerse.reference}</strong><br/><br/>${currentVerse.pieces.join(' ')}`;
      document.getElementById('explanation').textContent = currentVerse.explanation;
    }

    function resetPuzzle(){
      for (let i=shuffledPieces.length-1;i>0;i--){
        const j = Math.floor(Math.random()*(i+1));
        [shuffledPieces[i],shuffledPieces[j]]=[shuffledPieces[j],shuffledPieces[i]];
      }
      selectedPiece=null; renderPuzzle(); hintUsed=false;
    }

    function newGame(){
      document.getElementById('resultScreen').style.display='none';
      document.getElementById('puzzleScreen').style.display='block';
      loadRandomVerse();
    }

    function saveResult(){
      const text = `${currentVerse.reference}\n\n${currentVerse.pieces.join(' ')}\n\n${currentVerse.explanation}`;
      if (navigator.share){
        navigator.share({title:'말씀 조각 맞추기 결과', text});
      } else {
        navigator.clipboard.writeText(text).then(()=>alert('결과가 클립보드에 복사되었습니다! 📋'))
          .catch(()=>{
            const ta=document.createElement('textarea'); ta.value=text; document.body.appendChild(ta);
            ta.select(); document.execCommand('copy'); document.body.removeChild(ta);
            alert('결과가 클립보드에 복사되었습니다! 📋');
          });
      }
    }

    // 관리자
    function showPasswordModal(){
      document.getElementById('passwordModal').classList.remove('hidden');
      document.getElementById('passwordInput').focus();
    }
    function closePasswordModal(){
      document.getElementById('passwordModal').classList.add('hidden');
      document.getElementById('passwordInput').value='';
    }
    function checkPassword(){
      const pw = document.getElementById('passwordInput').value;
      if (pw===ADMIN_PASSWORD){ closePasswordModal(); showAdminScreen(); }
      else { alert('비밀번호가 틀렸습니다.'); document.getElementById('passwordInput').value=''; }
    }
    function showAdminScreen(){
      document.getElementById('homeScreen').style.display='none';
      document.getElementById('adminScreen').style.display='block';
      renderVerseList(); clearForm();
    }

    function renderVerseList(){
      const verses = loadVerses();
      const container = document.getElementById('verseListContainer');
      if (verses.length===0){
        container.innerHTML = '<p style="text-align:center;color:#999;">등록된 구절이 없습니다.</p>'; return;
      }
      container.innerHTML = verses.map((v,i)=>`
        <div class="verse-item">
          <div class="verse-reference">${v.reference}</div>
          <div class="verse-pieces">${v.pieces.join(' ')}</div>
          <div class="verse-explanation">${v.explanation}</div>
          <div class="verse-actions">
            <button class="btn edit-btn" onclick="editVerse(${i})" type="button">✏️ 수정</button>
            <button class="btn delete-btn" onclick="deleteVerse(${i})" type="button">🗑️ 삭제</button>
          </div>
        </div>
      `).join('');
    }

    function addPiece(){
      const container=document.getElementById('piecesContainer');
      const div=document.createElement('div');
      div.className='piece-item';
      div.innerHTML=`
        <input type="text" class="form-input piece-input" placeholder="새로운 문장"/>
        <button class="btn remove-piece-btn" onclick="removePiece(this)" type="button">삭제</button>
      `;
      container.appendChild(div);
    }

    function removePiece(btn){
      const container=document.getElementById('piecesContainer');
      if (container.children.length>1) btn.parentElement.remove();
      else alert('최소 하나의 조각은 필요합니다.');
    }

    function clearForm(){
      document.getElementById('newReference').value='';
      document.getElementById('newExplanation').value='';
      const container=document.getElementById('piecesContainer');
      container.innerHTML=`
        <div class="piece-item">
          <input type="text" class="form-input piece-input" placeholder="첫 번째 문장"/>
          <button class="btn remove-piece-btn" onclick="removePiece(this)" type="button">삭제</button>
        </div>
      `;
      editingIndex=-1;
    }

    function saveVerse(){
      const reference = document.getElementById('newReference').value.trim();
      const explanation = document.getElementById('newExplanation').value.trim();
      const pieceInputs = document.querySelectorAll('.piece-input');

      if (!reference){ alert('구절 참조를 입력해주세요.'); return; }
      if (!explanation){ alert('설교 해설을 입력해주세요.'); return; }

      const pieces=[];
      pieceInputs.forEach(i=>{ const v=i.value.trim(); if (v) pieces.push(v); });
      if (pieces.length<2){ alert('최소 2개 이상의 조각이 필요합니다.'); return; }

      const newVerse = { reference, pieces, explanation };
      const verses = loadVerses();

      if (editingIndex>=0){ verses[editingIndex]=newVerse; alert('구절이 수정되었습니다! ✨'); }
      else { verses.push(newVerse); alert('새 구절이 추가되었습니다! 🎉'); }

      saveVerses(verses);
      renderVerseList();
      clearForm();
    }

    function editVerse(index){
      const verses=loadVerses();
      const verse=verses[index];
      document.getElementById('newReference').value=verse.reference;
      document.getElementById('newExplanation').value=verse.explanation;

      const container=document.getElementById('piecesContainer');
      container.innerHTML='';
      verse.pieces.forEach(p=>{
        const div=document.createElement('div');
        div.className='piece-item';
        div.innerHTML=`
          <input type="text" class="form-input piece-input" value="${p}"/>
          <button class="btn remove-piece-btn" onclick="removePiece(this)" type="button">삭제</button>
        `;
        container.appendChild(div);
      });
      editingIndex=index;
      document.querySelector('.admin-form').scrollIntoView({behavior:'smooth'});
    }

    function deleteVerse(index){
      const verses=loadVerses();
      const verse=verses[index];
      if (confirm(`"${verse.reference}" 구절을 삭제하시겠습니까?`)){
        verses.splice(index,1);
        saveVerses(verses);
        renderVerseList();
        alert('구절이 삭제되었습니다.');
      }
    }

    // 비밀번호 입력 엔터
    document.getElementById('passwordInput').addEventListener('keypress', (e)=>{
      if (e.key==='Enter') checkPassword();
    });

    // 초기 로드: 기본값 세팅
    window.addEventListener('load', ()=>{
      if (!localStorage.getItem('bibleVerses')) saveVerses(defaultVerses);
    });

    // ===== Import/Export 바인딩 =====
    document.addEventListener('DOMContentLoaded', function () {
      const btnExport = document.getElementById("btnExport");
      const btnImport = document.getElementById("btnImport");
      const fileInput = document.getElementById("fileImport");
      if (!btnExport || !btnImport || !fileInput) return;

      // Export
      btnExport.addEventListener("click", ()=>{
        const verses = loadVerses();
        const blob = new Blob([JSON.stringify(verses, null, 2)], { type: "application/json" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url; a.download = "biblepuzzle_verses.json";
        document.body.appendChild(a); a.click(); a.remove();
        URL.revokeObjectURL(url);
      });

      // Import
      btnImport.addEventListener("click", ()=> fileInput.click());
      fileInput.addEventListener("change", async (e)=>{
        const file = e.target.files?.[0];
        if (!file) return;
        try{
          const text = await file.text();
          const data = JSON.parse(text);
          // 스키마 검증: reference/pieces 필요
          if (!Array.isArray(data)) throw new Error("최상위가 배열이어야 합니다.");
          for (const v of data){
            if (!v?.reference || !Array.isArray(v?.pieces)) {
              throw new Error("각 항목에 reference와 pieces(배열)가 필요합니다.");
            }
          }
          saveVerses(data);
          renderVerseList();
          alert("가져오기 완료!");
        }catch(err){
          alert("가져오기 실패: " + err.message);
        }finally{
          e.target.value = "";
        }
      });
    });
  </script>
</body>
</html>
