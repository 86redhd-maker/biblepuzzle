<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ÎßêÏîÄ Ï°∞Í∞Å ÎßûÏ∂îÍ∏∞</title>

  <!-- SUIT Ìè∞Ìä∏ -->
  <link href="https://cdn.jsdelivr.net/gh/sunn-us/SUIT/fonts/static/woff2/SUIT.css" rel="stylesheet">

  <style>
    /* === BiblePuzzle Pastel Playful ‚Äî Full CSS Overhaul (single source of truth) === */

    /* 0) Í≥µÌÜµ Î≥ÄÏàò */
    :root{
      --sky1:#cfe8ff; --sky2:#eaf6ff;
      --ink:#22324a; --sub:#5b6b7a; --edge:rgba(34,50,74,.12);
      --chip1:#BFE3FF; --chip2:#FFD1E5; --chip3:#FFF0A6; --chip4:#CCF3D2; --chip5:#E2D6FF;
      --ok:#65c18c; --warn:#f0c443;
      --r-card:26px; --r:14px;
      --shadow-lg:0 28px 80px rgba(17,24,39,.18); --shadow:0 10px 26px rgba(17,24,39,.14);
    }

    /* 1) Î≤†Ïù¥Ïä§ / Î∞∞Í≤Ω */
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%}
    body{
      font:16px/1.65 'SUIT', -apple-system, 'Apple SD Gothic Neo', system-ui, sans-serif;
      -webkit-font-smoothing:antialiased; text-rendering:optimizeLegibility;
      color:var(--ink);
      background:linear-gradient(180deg,var(--sky1),var(--sky2));
      padding:24px;
    }
    /* Íµ¨Î¶Ñ¬∑Î≥Ñ¬∑ÌçºÏ¶ê Ìå®ÌÑ¥ (base64/utf8 ÌòºÏö©, Î∏åÎùºÏö∞Ï†Ä Ìò∏Ìôò) */
    body::after{
      content:""; position:fixed; inset:0; pointer-events:none; z-index:0;
      background-image:
        /* ÌÅ∞ Íµ¨Î¶Ñ */
        url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='260' height='120'><path fill='%23fff' fill-opacity='.92' d='M50 95h160a44 44 0 1 0-30-76 60 60 0 0 0-98 28 30 30 0 1 0-32 48z'/></svg>"),
        /* ÏûëÏùÄ Íµ¨Î¶Ñ */
        url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='180' height='90'><path fill='%23fff' fill-opacity='.92' d='M36 74h108a28 28 0 1 0-20-48 48 48 0 0 0-66 24 22 22 0 1 0-22 24z'/></svg>"),
        /* Î≥Ñ (ÏûëÏùÄ Î∞òÎ≥µ) */
        url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIHZpZXdCb3g9IjAgMCAxOCAxOCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjZmZlMzdhIiBkPSJNOSAwbDIgNSA1IDItNSAybC0yIDUtMi01LTUtMiA1LTJ6Ii8+PC9zdmc+),
        /* ÌçºÏ¶ê(ÎÖ∏Îûë) */
        url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='84' height='84' viewBox='0 0 84 84'><path fill='%23ffd96b' d='M30 8a8 8 0 1 0 16 0h10c8 0 14 6 14 14v6a8 8 0 1 0 0 16v8c0 8-6 14-14 14H46a8 8 0 1 0-16 0H20c-8 0-14-6-14-14V44a8 8 0 1 0 0-16v-6C6 14 12 8 20 8h10z'/></svg>"),
        /* ÌçºÏ¶ê(ÌïëÌÅ¨) */
        url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='84' height='84' viewBox='0 0 84 84'><path fill='%23ffb3c7' d='M30 8a8 8 0 1 0 16 0h10c8 0 14 6 14 14v6a8 8 0 1 0 0 16v8c0 8-6 14-14 14H46a8 8 0 1 0-16 0H20c-8 0-14-6-14-14V44a8 8 0 1 0 0-16v-6C6 14 12 8 20 8h10z'/></svg>");
      background-repeat: no-repeat, no-repeat, repeat, no-repeat, no-repeat;
      background-size: 260px 120px, 180px 90px, 18px 18px, 84px 84px, 84px 84px;
      background-position: 8% 16%, 82% 8%, center 28%, 90% 78%, 12% 82%;
      opacity:.96;
    }

    /* 2) Ïª®ÌÖåÏù¥ÎÑà */
    .container{ max-width:980px; margin:0 auto; position:relative; z-index:1 }

    /* 3) Ìôà(ÌûàÏñ¥Î°ú) ‚Äî Ïú†Î¶¨Ïπ¥Îìú */
    .home-screen{
      display:grid; place-items:center; text-align:center;
      min-height:64vh; padding:56px 28px;
      background:linear-gradient(180deg, rgba(255,255,255,.82), rgba(255,255,255,.92));
      border:1px solid rgba(255,255,255,.8); border-radius:var(--r-card);
      box-shadow:var(--shadow-lg); color:var(--ink);
    }
    .admin-link{
      position:absolute; top:20px; right:20px;
      background:rgba(255,255,255,.6); color:#0f2a5a; border:1px solid rgba(34,50,74,.12);
      padding:8px 14px; border-radius:999px; font-size:.9rem; cursor:pointer; transition:.2s;
      box-shadow:0 6px 18px rgba(17,24,39,.08);
    }
    .admin-link:hover{ transform:translateY(-1px) }
    .home-screen h1{
      font-size:clamp(28px,5vw,42px); font-weight:900; letter-spacing:.2px; margin-bottom:8px;
    }
    .home-screen h1::before{
      content:"üß©"; margin-right:.35em; filter:drop-shadow(0 3px 6px rgba(0,0,0,.12))
    }
    .home-screen p{ font-size:clamp(15px,2.2vw,18px); color:var(--sub); margin-bottom:22px }
    .start-btn{
      border:1px solid var(--edge);
      background:
        radial-gradient(120% 100% at 50% -10%, rgba(255,255,255,.75), transparent 40%),
        linear-gradient(#fff,#f7f7f7);
      color:#0f2a5a; font-weight:900; font-size:1.06rem;
      padding:14px 28px; border-radius:999px; cursor:pointer;
      box-shadow:0 12px 28px rgba(34,50,74,.18);
      transition:transform .15s, box-shadow .15s;
    }
    .start-btn:hover{ transform:translateY(-2px) scale(1.01) }
    .start-btn:active{ transform:translateY(0) scale(.99) }

    /* 4) ÌçºÏ¶ê ÌôîÎ©¥ */
    .puzzle-screen{ display:none; padding:28px 28px 36px }
    .puzzle-header{ text-align:center; margin-bottom:18px }
    .puzzle-header h2{ font-size:clamp(20px,3.2vw,26px); font-weight:900; color:#1e2b46; margin-bottom:8px }
    .verse-info{
      display:inline-flex; align-items:center; gap:.5rem;
      background:#fff; color:#334155; font-weight:900;
      border:1px solid var(--edge); padding:8px 14px; border-radius:999px;
      box-shadow:0 6px 16px rgba(17,24,39,.08);
    }
    .instruction{
      background:linear-gradient(180deg,#eef6ff,#eaf2ff);
      border:1px solid rgba(110,168,254,.35);
      color:#0f3a75; border-radius:14px; padding:14px 16px; font-weight:800;
      margin:18px 0 20px;
    }

    .puzzle-area{
      display:grid; gap:12px;
      grid-template-columns:repeat(auto-fit,minmax(170px,1fr));
      background:linear-gradient(180deg,#fbfdff,#f5f8fe);
      border:1px solid rgba(34,50,74,.10);
      border-radius:16px; padding:18px; min-height:260px;
      box-shadow:0 12px 26px rgba(17,24,39,.08) inset;
    }
    .puzzle-piece{
      border:none; border-radius:14px; padding:14px 16px;
      font-weight:900; line-height:1.4; color:#253551;
      box-shadow:0 10px 22px rgba(34,50,74,.10);
      user-select:none; -webkit-tap-highlight-color:transparent;
      transition:transform .12s ease, box-shadow .12s ease, filter .12s ease;
    }
    .puzzle-piece:hover{ transform:translateY(-2px); box-shadow:0 16px 28px rgba(34,50,74,.14) }
    .puzzle-piece:active{ transform:scale(.985) }
    .puzzle-piece.selected{ outline:3px solid rgba(110,168,254,.55); filter:saturate(110%) }
    /* ÌååÏä§ÌÖî ÏàúÌôò */
    .puzzle-piece:nth-child(5n+1){ background:var(--chip1) }
    .puzzle-piece:nth-child(5n+2){ background:var(--chip2) }
    .puzzle-piece:nth-child(5n+3){ background:var(--chip3) }
    .puzzle-piece:nth-child(5n+4){ background:var(--chip4) }
    .puzzle-piece:nth-child(5n){   background:var(--chip5) }

    .controls{ display:flex; gap:10px; justify-content:center; flex-wrap:wrap }
    .btn{
      border:1px solid var(--edge);
      background:
        radial-gradient(120% 100% at 50% -10%, rgba(255,255,255,.65), transparent 40%),
        linear-gradient(#fff,#f7f7f7);
      color:#1f2d40; font-weight:800; min-height:44px; padding:12px 18px;
      border-radius:999px; cursor:pointer; box-shadow:0 6px 18px rgba(31,41,55,.12);
      transition:transform .15s, box-shadow .15s;
    }
    .btn:hover{ transform:translateY(-1px) scale(1.01) }
    .btn:active{ transform:translateY(0) scale(.99) }
    .hint-btn{
      background:linear-gradient(#eaf4ff,#e2f0ff);
      border-color:rgba(110,168,254,.45);
      color:#0f3a75;
    }
    .back-btn{ background:linear-gradient(#f6f6f6,#eeeeee) }

    /* 5) Í≤∞Í≥º ÌôîÎ©¥ */
    .result-screen{ display:none; padding:28px; text-align:center }
    .result-title{ font-size:clamp(22px,3.6vw,28px); color:var(--ok); font-weight:900; margin-bottom:14px }
    .correct-verse{
      background:linear-gradient(180deg,#fcfffb,#f7fff7);
      border:1px solid rgba(101,193,140,.45);
      border-radius:18px; padding:22px; margin:18px 0;
      box-shadow:0 12px 32px rgba(17,24,39,.10);
      font-size:1.08rem; line-height:1.65; color:#1f2937; font-weight:800;
    }
    .explanation{
      background:linear-gradient(180deg,#fff9e6,#fff4d6);
      border-left:4px solid var(--warn); border-radius:10px;
      padding:18px; margin:16px 0; text-align:left; color:#374151; font-weight:800;
    }
    .explanation h4{ color:#8b6c53; margin:0 0 8px }

    /* 6) Í¥ÄÎ¶¨Ïûê ÌôîÎ©¥ */
    .admin-screen{ display:none; padding:28px }
    .admin-header{ text-align:center; color:#8b6c53; margin-bottom:22px }
    .verse-list{ margin-bottom:24px }
    .verse-item{
      background:linear-gradient(180deg,#f9fafb,#f7f7f7);
      border:1px solid rgba(17,24,39,.08);
      border-left:4px solid #8b6c53;
      border-radius:14px; padding:18px; margin-bottom:12px;
    }
    .verse-reference{ font-weight:900; color:#8b6c53; margin-bottom:8px; letter-spacing:.2px }
    .verse-pieces{ margin-bottom:8px; line-height:1.55; color:#111827; font-weight:800 }
    .verse-explanation{ font-size:.95rem; color:#6b7280 }
    .verse-actions{ margin-top:10px }

    .admin-form{
      background:#fff; border:1px solid rgba(17,24,39,.08); border-radius:16px; padding:22px;
      box-shadow:0 8px 20px rgba(17,24,39,.06); margin-bottom:18px;
    }
    .form-group{ margin-bottom:16px }
    .form-label{ display:block; color:#8b6c53; font-weight:900; margin-bottom:8px }
    .form-input{
      width:100%; padding:12px 14px; border:1px solid rgba(34,50,74,.14); border-radius:10px; font:inherit;
      transition:border-color .15s;
    }
    .form-input:focus{ outline:none; border-color:rgba(110,168,254,.6) }
    .form-textarea{ min-height:120px; resize:vertical }
    .piece-item{ display:flex; gap:10px; align-items:center; margin-bottom:10px }
    .piece-input{ flex:1 }
    .add-piece-btn{ background:linear-gradient(#eafdf0,#e1f9ea); color:#0d5e34; border-color:rgba(101,193,140,.45) }
    .remove-piece-btn{ background:linear-gradient(#ffe9ea,#ffdfe1); border-color:rgba(239,83,80,.35) }
    .edit-btn{ background:linear-gradient(#eaf4ff,#e2f0ff); border-color:rgba(110,168,254,.45); color:#0f3a75 }
    .delete-btn{ background:linear-gradient(#ffe9ea,#ffdfe1) }
    .back-btn{ background:linear-gradient(#f5f5f5,#eeeeee) }

    /* 7) Î™®Îã¨ */
    .password-modal{ position:fixed; inset:0; display:flex; justify-content:center; align-items:center;
      background:rgba(15,23,42,.45); backdrop-filter: blur(6px); z-index:1000 }
    .password-modal-content{
      background:linear-gradient(180deg,#ffffff,#fbfbfb);
      border:1px solid rgba(255,255,255,.7); border-radius:16px; padding:26px; width:min(420px,92%);
      box-shadow:var(--shadow); text-align:center;
    }
    .password-input{
      width:100%; padding:12px; margin:16px 0; border:1px solid rgba(34,50,74,.14); border-radius:10px; text-align:center; font-size:1.05rem;
    }
    .hidden{ display:none !important }

    /* 8) Î™®Î∞îÏùº */
    @media (max-width:768px){
      body{ padding:16px }
      .home-screen{ min-height:58vh; padding:40px 18px }
      .puzzle-screen,.result-screen,.admin-screen{ padding:22px }
      .puzzle-area{ grid-template-columns:repeat(auto-fit,minmax(140px,1fr)) }
    }

    /* Ï†ëÍ∑ºÏÑ± */
    :focus-visible{ outline:3px solid rgba(110,168,254,.6); outline-offset:2px; border-radius:10px }

    /* === Hotfix: ÌÅ¥Î¶≠ ÎßâÌûò & Îã§Ïù¥ÏïÑ Ìå®ÌÑ¥ Ï†úÍ±∞ === */

/* Î∞∞Í≤Ω Îç∞ÏΩî Î†àÏù¥Ïñ¥Î•º 'ÏßÑÏßú Îí§'Î°ú Î≥¥ÎÇ¥ÏÑú ÌÅ¥Î¶≠ Ïïà ÎßâÍ≤å */
body::after{
  pointer-events: none !important;
  z-index: -1 !important;            /* üëà Ïª®ÌÖêÏ∏† Îí§Î°ú ÌôïÏã§Ìûà */
  opacity: .85 !important;
  /* Î≥Ñ(ÏûëÏùÄ Î∞òÎ≥µ) Ï†úÍ±∞ ‚Üí Îã§Ïù¥ÏïÑ ÎäêÎÇå ÏõêÏù∏ */
  background-image:
    /* ÌÅ∞ Íµ¨Î¶Ñ */
    url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='260' height='120'><path fill='%23fff' fill-opacity='.92' d='M50 95h160a44 44 0 1 0-30-76 60 60 0 0 0-98 28 30 30 0 1 0-32 48z'/></svg>"),
    /* ÏûëÏùÄ Íµ¨Î¶Ñ */
    url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='180' height='90'><path fill='%23fff' fill-opacity='.92' d='M36 74h108a28 28 0 1 0-20-48 48 48 0 0 0-66 24 22 22 0 1 0-22 24z'/></svg>"),
    /* ÌçºÏ¶ê(ÎÖ∏Îûë) */
    url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='84' height='84' viewBox='0 0 84 84'><path fill='%23ffd96b' d='M30 8a8 8 0 1 0 16 0h10c8 0 14 6 14 14v6a8 8 0 1 0 0 16v8c0 8-6 14-14 14H46a8 8 0 1 0-16 0H20c-8 0-14-6-14-14V44a8 8 0 1 0 0-16v-6C6 14 12 8 20 8h10z'/></svg>"),
    /* ÌçºÏ¶ê(ÌïëÌÅ¨) */
    url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='84' height='84' viewBox='0 0 84 84'><path fill='%23ffb3c7' d='M30 8a8 8 0 1 0 16 0h10c8 0 14 6 14 14v6a8 8 0 1 0 0 16v8c0 8-6 14-14 14H46a8 8 0 1 0-16 0H20c-8 0-14-6-14-14V44a8 8 0 1 0 0-16v-6C6 14 12 8 20 8h10z'/></svg>");
  background-repeat: no-repeat, no-repeat, no-repeat, no-repeat !important;
  background-size: 260px 120px, 180px 90px, 84px 84px, 84px 84px !important;
  background-position: 8% 16%, 82% 10%, 90% 78%, 12% 82% !important;
}

/* Ïª®ÌÖêÏ∏† Ïä§ÌÉùÏùÑ ÏúÑÎ°ú (ÌòπÏãú Î™®Î•º ÌÖåÎßà Ï∂©Îèå Î∞©ÏßÄ) */
.container{ position: relative !important; z-index: 0 !important; }
.home-screen, .puzzle-screen, .result-screen, .admin-screen{ position: relative; z-index: 1; }

/* Î≤ÑÌäºÏùÄ Î∞òÎìúÏãú ÌÅ¥Î¶≠ÎêòÎèÑÎ°ù ÏïàÏ†ÑÏû•Ïπò (Î≥¥ÌÜµ ÌïÑÏöî ÏóÜÏßÄÎßå ÌòπÏãú ÎåÄÎπÑ) */
button, .btn, .start-btn { pointer-events: auto !important; }

/* ÎπÑÎ∞ÄÎ≤àÌò∏ Î™®Îã¨Ïù¥ Ïó¥Î†§ÏûàÏßÄ ÏïäÏùÑ ÎïåÎäî Ï†àÎåÄ Í∞ÄÎ¶¨ÏßÄ ÏïäÎèÑÎ°ù */
.password-modal.hidden { display: none !important; opacity: 0 !important; }
  </style>
</head>

<body>
  <div class="container">
    <!-- Ìôà ÌôîÎ©¥ -->
    <div class="home-screen" id="homeScreen">
      <button class="admin-link" onclick="showPasswordModal()">‚öôÔ∏è Í¥ÄÎ¶¨Ïûê</button>
      <h1>üß© ÎßêÏîÄ Ï°∞Í∞Å ÎßûÏ∂îÍ∏∞</h1>
      <p>ÏÑ±Í≤Ω Íµ¨Ï†àÏùò ÏàúÏÑúÎ•º ÎßûÏ∂∞Î≥¥ÏÑ∏Ïöî!<br/>ÎßêÏîÄÏùò ÌùêÎ¶ÑÏùÑ ÎäêÎÅºÎ©∞ Îçî ÍπäÏù¥ Î¨µÏÉÅÌï¥Î≥¥ÏïÑÏöî.</p>
      <button class="start-btn" onclick="startGame()">ÏãúÏûëÌïòÍ∏∞</button>
    </div>

    <!-- ÌçºÏ¶ê ÌôîÎ©¥ -->
    <div class="puzzle-screen" id="puzzleScreen">
      <div class="puzzle-header">
        <h2>ÎßêÏîÄ Ï°∞Í∞ÅÏùÑ ÏàúÏÑúÎåÄÎ°ú Î∞∞Ïó¥Ìï¥Î≥¥ÏÑ∏Ïöî</h2>
        <div class="verse-info" id="verseInfo">ÎßàÌÉúÎ≥µÏùå 5:14-16</div>
      </div>

      <div class="instruction">
        üì± <strong>ÏÇ¨Ïö©Î≤ï:</strong> Ï≤´ Î≤àÏß∏ Ï°∞Í∞ÅÏùÑ ÌÅ¥Î¶≠ÌïòÍ≥†, Î∞îÍæ∏Í≥† Ïã∂ÏùÄ Îëê Î≤àÏß∏ Ï°∞Í∞ÅÏùÑ ÌÅ¥Î¶≠ÌïòÎ©¥ ÏúÑÏπòÍ∞Ä Î∞îÎÄùÎãàÎã§!
      </div>

      <div class="puzzle-area" id="puzzleArea"></div>

      <div class="controls">
        <button class="btn hint-btn" onclick="showHint()">üí° ÌûåÌä∏</button>
        <button class="btn" onclick="checkAnswer()">Ï†ïÎãµ ÌôïÏù∏</button>
        <button class="btn" onclick="resetPuzzle()">Îã§Ïãú ÏÑûÍ∏∞</button>
        <button class="btn back-btn" onclick="goHome()">üè† Ìôà</button>
      </div>
    </div>

    <!-- Í≤∞Í≥º ÌôîÎ©¥ -->
    <div class="result-screen" id="resultScreen">
      <h2 class="result-title">üéâ Ï†ïÎãµÏûÖÎãàÎã§!</h2>
      <div class="correct-verse" id="correctVerse"></div>

      <div class="explanation">
        <h4>üìñ ÎßêÏîÄ Î¨µÏÉÅ</h4>
        <p id="explanation"></p>
      </div>

      <div class="share-controls">
        <button class="btn" onclick="saveResult()">üì± Í≤∞Í≥º Ï†ÄÏû•</button>
        <button class="btn new-game-btn" onclick="newGame()">ÏÉàÎ°úÏö¥ ÌçºÏ¶ê</button>
        <button class="btn back-btn" onclick="goHome()">üè† Ìôà</button>
      </div>
    </div>

    <!-- Í¥ÄÎ¶¨Ïûê ÌôîÎ©¥ -->
    <div class="admin-screen" id="adminScreen">
      <div class="admin-header">
        <h2>‚öôÔ∏è Íµ¨Ï†à Í¥ÄÎ¶¨</h2>
        <p>ÏÑ±Í≤Ω Íµ¨Ï†àÏùÑ Ï∂îÍ∞ÄÌïòÍ±∞ÎÇò ÏàòÏ†ïÌï† Ïàò ÏûàÏäµÎãàÎã§</p>
      </div>

      <!-- JSON Import/Export -->
      <div class="admin-tools" style="display:flex; gap:8px; margin:12px 0;">
        <button class="btn" id="btnExport" type="button">JSON ÎÇ¥Î≥¥ÎÇ¥Í∏∞</button>
        <button class="btn" id="btnImport" type="button">JSON Í∞ÄÏ†∏Ïò§Í∏∞</button>
        <input type="file" id="fileImport" accept="application/json" hidden />
      </div>

      <!-- ÏÉà Íµ¨Ï†à Ï∂îÍ∞Ä Ìèº -->
      <div class="admin-form">
        <h3 style="color:#8b6c53; margin-bottom:20px;">ÏÉà Íµ¨Ï†à Ï∂îÍ∞Ä</h3>

        <div class="form-group">
          <label class="form-label">Íµ¨Ï†à Ï∞∏Ï°∞ (Ïòà: ÎßàÌÉúÎ≥µÏùå 5:14-16)</label>
          <input type="text" class="form-input" id="newReference" placeholder="ÏÑ±Í≤ΩÏ±Ö Ïû•:Ï†à"/>
        </div>

        <div class="form-group">
          <label class="form-label">ÎßêÏîÄ Ï°∞Í∞ÅÎì§</label>
          <div id="piecesContainer">
            <div class="piece-item">
              <input type="text" class="form-input piece-input" placeholder="Ï≤´ Î≤àÏß∏ Î¨∏Ïû•"/>
              <button class="btn remove-piece-btn" onclick="removePiece(this)" type="button">ÏÇ≠Ï†ú</button>
            </div>
          </div>
          <button class="btn add-piece-btn" onclick="addPiece()" type="button">+ Ï°∞Í∞Å Ï∂îÍ∞Ä</button>
        </div>

        <div class="form-group">
          <label class="form-label">ÏÑ§Íµê Ìï¥ÏÑ§</label>
          <textarea class="form-input form-textarea" id="newExplanation" placeholder="Ïù¥ ÎßêÏîÄÏùò ÏùòÎØ∏ÏôÄ ÍµêÌõàÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî"></textarea>
        </div>

        <div style="text-align:center;">
          <button class="btn" onclick="saveVerse()" type="button">üíæ Ï†ÄÏû•ÌïòÍ∏∞</button>
          <button class="btn" onclick="clearForm()" type="button">üîÑ Ï¥àÍ∏∞Ìôî</button>
        </div>
      </div>

      <!-- Í∏∞Ï°¥ Íµ¨Ï†à Î™©Î°ù -->
      <div class="verse-list">
        <h3 style="color:#8b6c53; margin-bottom:20px;">Îì±Î°ùÎêú Íµ¨Ï†àÎì§</h3>
        <div id="verseListContainer"></div>
      </div>

      <div style="text-align:center; margin-top:30px;">
        <button class="btn back-btn" onclick="goHome()" type="button">üè† ÌôàÏúºÎ°ú ÎèåÏïÑÍ∞ÄÍ∏∞</button>
      </div>
    </div>
  </div>

  <!-- ÎπÑÎ∞ÄÎ≤àÌò∏ Î™®Îã¨ -->
  <div class="password-modal hidden" id="passwordModal">
    <div class="password-modal-content">
      <h3 style="color:#8b6c53; margin-bottom:20px;">Í¥ÄÎ¶¨Ïûê ÎπÑÎ∞ÄÎ≤àÌò∏</h3>
      <input type="password" class="password-input" id="passwordInput" placeholder="ÎπÑÎ∞ÄÎ≤àÌò∏Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî"/>
      <div>
        <button class="btn" onclick="checkPassword()" type="button">ÌôïÏù∏</button>
        <button class="btn back-btn" onclick="closePasswordModal()" type="button">Ï∑®ÏÜå</button>
      </div>
    </div>
  </div>

  <script>
    // Í∏∞Î≥∏ ÏÑ±Í≤Ω Íµ¨Ï†à Îç∞Ïù¥ÌÑ∞
    const defaultVerses = [
      {
        reference: "ÎßàÌÉúÎ≥µÏùå 5:14-16",
        pieces: [
          "ÎÑàÌù¨Îäî ÏÑ∏ÏÉÅÏùò ÎπõÏù¥Îùº",
          "ÏÇ∞ ÏúÑÏóê ÏûàÎäî ÎèôÎÑ§Í∞Ä Ïà®Í≤®ÏßÄÏßÄ Î™ªÌï† Í≤ÉÏù¥Ïöî",
          "ÏÇ¨ÎûåÏù¥ Îì±Î∂àÏùÑ ÏºúÏÑú Îßê ÏïÑÎûòÏóê ÎëêÏßÄ ÏïÑÎãàÌïòÍ≥†",
          "Îì±Í≤Ω ÏúÑÏóê ÎëêÎÇòÎãà",
          "Ïù¥Í∞ôÏù¥ ÎÑàÌù¨ ÎπõÏù¥ ÏÇ¨Îûå ÏïûÏóê ÎπÑÏπòÍ≤å ÌïòÏó¨",
          "Í∑∏Îì§Î°ú ÎÑàÌù¨ Ï∞©Ìïú ÌñâÏã§ÏùÑ Î≥¥Í≥†",
          "ÌïòÎäòÏóê Í≥ÑÏã† ÎÑàÌù¨ ÏïÑÎ≤ÑÏßÄÍªò ÏòÅÍ¥ëÏùÑ ÎèåÎ¶¨Í≤å ÌïòÎùº"
        ],
        explanation: "Ïù¥ ÎßêÏîÄÏùÄ Í∑∏Î¶¨Ïä§ÎèÑÏù∏Îì§Ïù¥ ÏÑ∏ÏÉÅÏóêÏÑú ÎπõÏùò Ïó≠Ìï†ÏùÑ Í∞êÎãπÌï¥Ïïº Ìï®ÏùÑ ÍµêÌõàÌï©ÎãàÎã§. Ïö∞Î¶¨Ïùò Ï∞©Ìïú ÌñâÏã§Í≥º ÏÇ∂ÏùÑ ÌÜµÌï¥ ÌïòÎÇòÎãòÏùò ÏòÅÍ¥ëÏùÑ ÎìúÎü¨ÎÇ¥Ïïº ÌïúÎã§Îäî ÏùòÎØ∏ÏûÖÎãàÎã§."
      },
      {
        reference: "ÏöîÌïúÎ≥µÏùå 3:16",
        pieces: [
          "ÌïòÎÇòÎãòÏù¥ ÏÑ∏ÏÉÅÏùÑ Ïù¥Ï≤òÎüº ÏÇ¨ÎûëÌïòÏÇ¨",
          "ÎèÖÏÉùÏûêÎ•º Ï£ºÏÖ®ÏúºÎãà",
          "Ïù¥Îäî Í∑∏Î•º ÎØøÎäî ÏûêÎßàÎã§",
          "Î©∏ÎßùÌïòÏßÄ ÏïäÍ≥†",
          "ÏòÅÏÉùÏùÑ ÏñªÍ≤å ÌïòÎ†§ ÌïòÏã¨Ïù¥Îùº"
        ],
        explanation: "ÏÑ±Í≤ΩÏóêÏÑú Í∞ÄÏû• ÏÇ¨ÎûëÎ∞õÎäî Íµ¨Ï†à Ï§ë ÌïòÎÇòÎ°ú, ÌïòÎÇòÎãòÏùò Î¨¥Ï°∞Í±¥Ï†ÅÏù∏ ÏÇ¨ÎûëÍ≥º Íµ¨ÏõêÏùò ÏùÄÌòúÎ•º Î≥¥Ïó¨Ï£ºÎäî ÎßêÏîÄÏûÖÎãàÎã§."
      }
    ];

    // ÏÉÅÌÉú
    let currentVerse = null;
    let shuffledPieces = [];
    let hintUsed = false;
    let editingIndex = -1;
    let selectedPiece = null;

    // Í¥ÄÎ¶¨Ïûê ÎπÑÎ∞ÄÎ≤àÌò∏
    const ADMIN_PASSWORD = "jesus2024";

    // Ï†ÄÏû•/Î∂àÎü¨Ïò§Í∏∞
    function loadVerses(){
      const saved = localStorage.getItem('bibleVerses');
      if (saved) return JSON.parse(saved);
      saveVerses(defaultVerses);
      return defaultVerses;
    }
    function saveVerses(verses){
      localStorage.setItem('bibleVerses', JSON.stringify(verses));
    }

    // Í≤åÏûÑ ÌîåÎ°úÏö∞
    function startGame(){
      document.getElementById('homeScreen').style.display='none';
      document.getElementById('puzzleScreen').style.display='block';
      loadRandomVerse();
    }
    function goHome(){
      document.getElementById('puzzleScreen').style.display='none';
      document.getElementById('resultScreen').style.display='none';
      document.getElementById('adminScreen').style.display='none';
      document.getElementById('homeScreen').style.display='block';
    }

    function loadRandomVerse(){
      const verses = loadVerses();
      if (verses.length===0){
        alert('Îì±Î°ùÎêú Íµ¨Ï†àÏù¥ ÏóÜÏäµÎãàÎã§. Í¥ÄÎ¶¨Ïûê ÌôîÎ©¥ÏóêÏÑú Íµ¨Ï†àÏùÑ Ï∂îÍ∞ÄÌï¥Ï£ºÏÑ∏Ïöî.');
        goHome();
        return;
      }
      const randomIndex = Math.floor(Math.random()*verses.length);
      currentVerse = verses[randomIndex];
      document.getElementById('verseInfo').textContent = currentVerse.reference;

      shuffledPieces = [...currentVerse.pieces];
      for (let i=shuffledPieces.length-1;i>0;i--){
        const j = Math.floor(Math.random()*(i+1));
        [shuffledPieces[i],shuffledPieces[j]]=[shuffledPieces[j],shuffledPieces[i]];
      }
      renderPuzzle();
      hintUsed=false; selectedPiece=null;
    }

    function renderPuzzle(){
      const puzzleArea = document.getElementById('puzzleArea');
      puzzleArea.innerHTML='';
      shuffledPieces.forEach((piece,index)=>{
        const el=document.createElement('div');
        el.className='puzzle-piece';
        el.textContent=piece;
        el.dataset.index=index;
        el.addEventListener('click',()=>handlePieceClick(el));
        puzzleArea.appendChild(el);
      });
    }

    function handlePieceClick(clicked){
      if (!selectedPiece){
        selectedPiece=clicked; clicked.classList.add('selected'); return;
      }
      if (selectedPiece===clicked){
        clicked.classList.remove('selected'); selectedPiece=null; return;
      }
      const a = parseInt(selectedPiece.dataset.index,10);
      const b = parseInt(clicked.dataset.index,10);
      [shuffledPieces[a],shuffledPieces[b]]=[shuffledPieces[b],shuffledPieces[a]];
      selectedPiece.classList.remove('selected'); selectedPiece=null;
      renderPuzzle();
    }

    function showHint(){
      if (hintUsed) return;
      const firstPiece = currentVerse.pieces[0];
      document.querySelectorAll('.puzzle-piece').forEach(p=>{
        if (p.textContent===firstPiece){
          p.style.border='3px solid #ffc107';
          p.style.background='#fff8dc';
        }
      });
      alert(`üí° ÌûåÌä∏: Ï≤´ Î≤àÏß∏ Î¨∏Ïû•ÏùÄ "${firstPiece}"ÏûÖÎãàÎã§.`);
      hintUsed=true;
    }

    function checkAnswer(){
      const ok = shuffledPieces.every((p,i)=>p===currentVerse.pieces[i]);
      if (ok) showResult(); else alert('ÏïÑÏßÅ ÏàúÏÑúÍ∞Ä ÎßûÏßÄ ÏïäÏïÑÏöî! Îã§Ïãú ÏãúÎèÑÌï¥Î≥¥ÏÑ∏Ïöî. üòä');
    }

    function showResult(){
      document.getElementById('puzzleScreen').style.display='none';
      document.getElementById('resultScreen').style.display='block';
      document.getElementById('correctVerse').innerHTML =
        `<strong>${currentVerse.reference}</strong><br/><br/>${currentVerse.pieces.join(' ')}`;
      document.getElementById('explanation').textContent = currentVerse.explanation;
    }

    function resetPuzzle(){
      for (let i=shuffledPieces.length-1;i>0;i--){
        const j = Math.floor(Math.random()*(i+1));
        [shuffledPieces[i],shuffledPieces[j]]=[shuffledPieces[j],shuffledPieces[i]];
      }
      selectedPiece=null; renderPuzzle(); hintUsed=false;
    }

    function newGame(){
      document.getElementById('resultScreen').style.display='none';
      document.getElementById('puzzleScreen').style.display='block';
      loadRandomVerse();
    }

    function saveResult(){
      const text = `${currentVerse.reference}\n\n${currentVerse.pieces.join(' ')}\n\n${currentVerse.explanation}`;
      if (navigator.share){
        navigator.share({title:'ÎßêÏîÄ Ï°∞Í∞Å ÎßûÏ∂îÍ∏∞ Í≤∞Í≥º', text});
      } else {
        navigator.clipboard.writeText(text).then(()=>alert('Í≤∞Í≥ºÍ∞Ä ÌÅ¥Î¶ΩÎ≥¥ÎìúÏóê Î≥µÏÇ¨ÎêòÏóàÏäµÎãàÎã§! üìã'))
          .catch(()=>{
            const ta=document.createElement('textarea'); ta.value=text; document.body.appendChild(ta);
            ta.select(); document.execCommand('copy'); document.body.removeChild(ta);
            alert('Í≤∞Í≥ºÍ∞Ä ÌÅ¥Î¶ΩÎ≥¥ÎìúÏóê Î≥µÏÇ¨ÎêòÏóàÏäµÎãàÎã§! üìã');
          });
      }
    }

    // Í¥ÄÎ¶¨Ïûê
    function showPasswordModal(){
      document.getElementById('passwordModal').classList.remove('hidden');
      document.getElementById('passwordInput').focus();
    }
    function closePasswordModal(){
      document.getElementById('passwordModal').classList.add('hidden');
      document.getElementById('passwordInput').value='';
    }
    function checkPassword(){
      const pw = document.getElementById('passwordInput').value;
      if (pw===ADMIN_PASSWORD){ closePasswordModal(); showAdminScreen(); }
      else { alert('ÎπÑÎ∞ÄÎ≤àÌò∏Í∞Ä ÌãÄÎ†∏ÏäµÎãàÎã§.'); document.getElementById('passwordInput').value=''; }
    }
    function showAdminScreen(){
      document.getElementById('homeScreen').style.display='none';
      document.getElementById('adminScreen').style.display='block';
      renderVerseList(); clearForm();
    }

    function renderVerseList(){
      const verses = loadVerses();
      const container = document.getElementById('verseListContainer');
      if (verses.length===0){
        container.innerHTML = '<p style="text-align:center;color:#999;">Îì±Î°ùÎêú Íµ¨Ï†àÏù¥ ÏóÜÏäµÎãàÎã§.</p>'; return;
      }
      container.innerHTML = verses.map((v,i)=>`
        <div class="verse-item">
          <div class="verse-reference">${v.reference}</div>
          <div class="verse-pieces">${v.pieces.join(' ')}</div>
          <div class="verse-explanation">${v.explanation}</div>
          <div class="verse-actions">
            <button class="btn edit-btn" onclick="editVerse(${i})" type="button">‚úèÔ∏è ÏàòÏ†ï</button>
            <button class="btn delete-btn" onclick="deleteVerse(${i})" type="button">üóëÔ∏è ÏÇ≠Ï†ú</button>
          </div>
        </div>
      `).join('');
    }

    function addPiece(){
      const container=document.getElementById('piecesContainer');
      const div=document.createElement('div');
      div.className='piece-item';
      div.innerHTML=`
        <input type="text" class="form-input piece-input" placeholder="ÏÉàÎ°úÏö¥ Î¨∏Ïû•"/>
        <button class="btn remove-piece-btn" onclick="removePiece(this)" type="button">ÏÇ≠Ï†ú</button>
      `;
      container.appendChild(div);
    }

    function removePiece(btn){
      const container=document.getElementById('piecesContainer');
      if (container.children.length>1) btn.parentElement.remove();
      else alert('ÏµúÏÜå ÌïòÎÇòÏùò Ï°∞Í∞ÅÏùÄ ÌïÑÏöîÌï©ÎãàÎã§.');
    }

    function clearForm(){
      document.getElementById('newReference').value='';
      document.getElementById('newExplanation').value='';
      const container=document.getElementById('piecesContainer');
      container.innerHTML=`
        <div class="piece-item">
          <input type="text" class="form-input piece-input" placeholder="Ï≤´ Î≤àÏß∏ Î¨∏Ïû•"/>
          <button class="btn remove-piece-btn" onclick="removePiece(this)" type="button">ÏÇ≠Ï†ú</button>
        </div>
      `;
      editingIndex=-1;
    }

    function saveVerse(){
      const reference = document.getElementById('newReference').value.trim();
      const explanation = document.getElementById('newExplanation').value.trim();
      const pieceInputs = document.querySelectorAll('.piece-input');

      if (!reference){ alert('Íµ¨Ï†à Ï∞∏Ï°∞Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.'); return; }
      if (!explanation){ alert('ÏÑ§Íµê Ìï¥ÏÑ§ÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.'); return; }

      const pieces=[];
      pieceInputs.forEach(i=>{ const v=i.value.trim(); if (v) pieces.push(v); });
      if (pieces.length<2){ alert('ÏµúÏÜå 2Í∞ú Ïù¥ÏÉÅÏùò Ï°∞Í∞ÅÏù¥ ÌïÑÏöîÌï©ÎãàÎã§.'); return; }

      const newVerse = { reference, pieces, explanation };
      const verses = loadVerses();

      if (editingIndex>=0){ verses[editingIndex]=newVerse; alert('Íµ¨Ï†àÏù¥ ÏàòÏ†ïÎêòÏóàÏäµÎãàÎã§! ‚ú®'); }
      else { verses.push(newVerse); alert('ÏÉà Íµ¨Ï†àÏù¥ Ï∂îÍ∞ÄÎêòÏóàÏäµÎãàÎã§! üéâ'); }

      saveVerses(verses);
      renderVerseList();
      clearForm();
    }

    function editVerse(index){
      const verses=loadVerses();
      const verse=verses[index];
      document.getElementById('newReference').value=verse.reference;
      document.getElementById('newExplanation').value=verse.explanation;

      const container=document.getElementById('piecesContainer');
      container.innerHTML='';
      verse.pieces.forEach(p=>{
        const div=document.createElement('div');
        div.className='piece-item';
        div.innerHTML=`
          <input type="text" class="form-input piece-input" value="${p}"/>
          <button class="btn remove-piece-btn" onclick="removePiece(this)" type="button">ÏÇ≠Ï†ú</button>
        `;
        container.appendChild(div);
      });
      editingIndex=index;
      document.querySelector('.admin-form').scrollIntoView({behavior:'smooth'});
    }

    function deleteVerse(index){
      const verses=loadVerses();
      const verse=verses[index];
      if (confirm(\`"\${verse.reference}" Íµ¨Ï†àÏùÑ ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?\`)){
        verses.splice(index,1);
        saveVerses(verses);
        renderVerseList();
        alert('Íµ¨Ï†àÏù¥ ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§.');
      }
    }

    // ÎπÑÎ∞ÄÎ≤àÌò∏ ÏóîÌÑ∞ÌÇ§
    document.getElementById('passwordInput').addEventListener('keypress', (e)=>{
      if (e.key==='Enter') checkPassword();
    });

    // Ï¥àÍ∏∞ Î°úÎìú: Í∏∞Î≥∏Í∞í ÏÑ∏ÌåÖ
    window.addEventListener('load', ()=>{
      if (!localStorage.getItem('bibleVerses')) saveVerses(defaultVerses);
    });

    // Import/Export Î∞îÏù∏Îî©
    document.addEventListener('DOMContentLoaded', function () {
      const btnExport = document.getElementById("btnExport");
      const btnImport = document.getElementById("btnImport");
      const fileInput = document.getElementById("fileImport");
      if (!btnExport || !btnImport || !fileInput) return;

      // Export
      btnExport.addEventListener("click", ()=>{
        const verses = loadVerses();
        const blob = new Blob([JSON.stringify(verses, null, 2)], { type: "application/json" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url; a.download = "biblepuzzle_verses.json";
        document.body.appendChild(a); a.click(); a.remove();
        URL.revokeObjectURL(url);
      });

      // Import
      btnImport.addEventListener("click", ()=> fileInput.click());
      fileInput.addEventListener("change", async (e)=>{
        const file = e.target.files?.[0];
        if (!file) return;
        try{
          const text = await file.text();
          const data = JSON.parse(text);
          if (!Array.isArray(data)) throw new Error("ÏµúÏÉÅÏúÑÍ∞Ä Î∞∞Ïó¥Ïù¥Ïñ¥Ïïº Ìï©ÎãàÎã§.");
          for (const v of data){
            if (!v?.reference || !Array.isArray(v?.pieces)) {
              throw new Error("Í∞Å Ìï≠Î™©Ïóê referenceÏôÄ pieces(Î∞∞Ïó¥)Í∞Ä ÌïÑÏöîÌï©ÎãàÎã§.");
            }
          }
          saveVerses(data);
          renderVerseList();
          alert("Í∞ÄÏ†∏Ïò§Í∏∞ ÏôÑÎ£å!");
        }catch(err){
          alert("Í∞ÄÏ†∏Ïò§Í∏∞ Ïã§Ìå®: " + err.message);
        }finally{
          e.target.value = "";
        }
      });
    });
  </script>
</body>
</html>
